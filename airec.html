

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Новый Локальный Chatbot</title>
    <script type="module">
        import { pipeline } from "https://cdn.jsdelivr.net/npm/@xenova/transformers";

        let model;
        const chatDiv = document.getElementById("chat");
        const inputElement = document.getElementById("input");
        const sendButton = document.getElementById("sendButton");

        async function loadModel() {
            console.log("Загрузка модели...");
            try {
                model = await pipeline("text-generation", "Xenova/gpt2");

                console.log("Модель загружена!");
            } catch (error) {
                console.error("Ошибка загрузки модели:", error);
                chatDiv.innerHTML += `<div class="bot">Ошибка загрузки модели. Проверьте консоль.</div>`;
            }
        }

        async function sendMessage() {
            const input = inputElement.value.trim();
            if (!input) return;
            chatDiv.innerHTML += `<div class="user">${input}</div>`;
            inputElement.value = "";

            if (!model) {
                chatDiv.innerHTML += `<div class="bot">Модель еще не загружена. Подождите...</div>`;
                return;
            }

            try {
                const response = await model(input, { max_new_tokens: 50 });
                console.log("Ответ модели:", response);
                chatDiv.innerHTML += `<div class="bot">${response[0].generated_text.replace(input, "").trim()}</div>`;
            } catch (error) {
                console.error("Ошибка при генерации ответа:", error);
                chatDiv.innerHTML += `<div class="bot">Произошла ошибка при обработке запроса.</div>`;
            }
        }

        sendButton.addEventListener("click", sendMessage);
        inputElement.addEventListener("keydown", (event) => {
            if (event.key === "Enter") {
                sendMessage();
            }
        });

        loadModel();
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        #chat {
            max-width: 500px;
            margin: auto;
            text-align: left;
        }
        .user, .bot {
            padding: 10px;
            margin: 5px;
            border-radius: 10px;
        }
        .user {
            background: #d1e7fd;
            text-align: right;
        }
        .bot {
            background: #e0e0e0;
        }
    </style>
</head>
<body>
    <h2>WinexAI Pro</h2>
    <strong>Report any problems</strong>
    <div id="chat"></div>
    <input id="input" type="text" placeholder="Message" />
    <button id="sendButton">Send</button>
</body>
</html>
